<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1" /> 
<title>微信支付</title>
<script src="__PUBLIC__/js/jquery/jquery-2.0.3.min.js"></script>
</head>
<body>	
	
	<img alt="模式二扫码支付" src="http://paysdk.weixin.qq.com/example/qrcode.php?data=<?php echo urlencode($url);?>" style="width:150px;height:150px;"/>
	
</body>
<script>
$(function(){
	//setInterval定时器，返回的id可以作为clearInterval的参数；若只想执行一次则可以用setTimeOut
	window.setInterval(function(){
		$.post(
			"{:url('/get_order_status')}",
			{
				out_trade_no:"{$trade_no}"
			},
			function(d){
				if(d=='pay_suc'){
					alert('付款成功');					
					
					$("#upay{$order_id}",window.parent.document).html('<span class="green">已付款</span>');//获取父类的指定元素，如id=upay{$order_id}的元素，将值传递过去，当前页面的父页面是order_member页面			
					parent.window.art.dialog.list['apply'].close();//调用父类窗口的方法
					
				}
			}
		);
	}, 2000); 
});	
</script>
</html>